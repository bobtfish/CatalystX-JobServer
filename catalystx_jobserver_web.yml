---
Model::MessageQueue:
    class: "CatalystX::JobServer::MessageQueue"
    args:
        user: platform
        pass: ders8pron
        port: 5672
        host: mq.cissme.com
        vhost: /
        channels:
            jobs:
                exchanges:
                    - type: topic
                      durable: 1
                      exchange: jobs
                queues:
                    - queue: jobs_queue
                      durable: 1
                      bind:
                        exchange: jobs
                        routing_key: "#"
                dispatch_to: ForkedJobRunner
                results_exchange: firehose
                results_routing_key: ""
            firehose:
                exchanges:
                    - type: topic
                      durable: 1
                      exchange: firehose
                queues:
# FIXME - Needs to go away if not listening, be anon - fixme!
                    - queue: firehose_log
                      durable: 1
                      bind:
                          exchange: firehose
                          routing_key: "#"
                dispatch_to: FireHoseLog
                results_exchange: firehose
                results_routing_key: ""
Model::FireHoseLog:
    class: "CatalystX::JobServer::LogWriter"
    args:
        output_file: "/space/logs/rabbitmq/firehose.log"
#Model::ForkedJobRunner:
#    class: "CatalystX::JobServer::JobRunner::Forked"
#    traits:
#        - PostForkCallback
#        - PublishSelf
#    args:
#        post_fork_callback: "AnyEvent::Util::close_all_fds_except(0, 1, 2); state51::Base->connect"
#        publish_self_every: 30
#        publish_self_to: orderxlsvalidate
#        jobs_registered:
#            - "state51::Job::OrderXLSValidate"
#            - "CatalystX::JobServer::Job::Test::RunForThirtySeconds"

